# Multiple neurons per layer 
# static amount of neurons layer and static amount of layers
# no use of chain rule 

import random 
import numpy 
import math 

class Neuron():
    def __init__(self, value=None):
        if value:
            self.value = value
        else:
            self.value = random.random()
        self.bias = random.random() 
        self.activation = 0

    def activate(self):
        # sigmoid actvition
        self.activation = 1 / (1 + math.exp(self.value * -1))

class HiddenNeuron(Neuron):
    def forward(self, weights, prev_neurons):
        self.value = self.getWeightedSum(weights, prev_neurons) + self.bias
        self.activate()
        print("Hidden neuron value " + str(self.value))
        print("Hidden neuron activation " + str(self.activation))
    
    def getWeightedSum(self,weights,prev_neurons):
        value = 0
        for i,neuron in enumerate(prev_neurons):
            value += weights[i] * neuron.activation
        return value

class OutputNeuron(Neuron):
    def __init__(self, reference_value):
        super().__init__()
        self.reference = reference_value

    def forward(self, weights, prev_neurons):
        self.value = self.getWeightedSum(weights, prev_neurons) + self.bias
        self.activate(prev_neurons)
    
    def getWeightedSum(self,weights,prev_neurons):
        value = 0
        for i,neuron in enumerate(prev_neurons):
            value += weights[i] * neuron.activation
        return value

    def activate(self, prev_neurons):
        # softmax activation
        sum_of_exp_values_of_previos_neurons = 0
        for neuron in prev_neurons:
            sum_of_exp_values_of_previos_neurons += math.exp(neuron.activation)
        self.activation = math.exp(self.activation) / (sum_of_exp_values_of_previos_neurons)
        print("Output neuron with reference value: " + str(self.reference) + " got prob: " + str(self.activation))

class Layer():
    def __init__(self):
        self.neurons = []
        self.weights = []
    
    def forward(self,previous_layer):
        for i,next_neuron in enumerate(self.neurons):
            next_neuron.forward(self.weights[i], previous_layer.neurons)

class InputLayer(Layer):
    def __init__(self, values):
        super().__init__()
        for value in values:
            self.neurons.append(Neuron(value))

class OutputLayer(Layer):
    def __init__(self,number_neurons,number_input_weights,values):
        super().__init__()
        self.weights = numpy.random.ranf((number_neurons,number_input_weights))
        for l in range(0,number_neurons):
            self.neurons.append(OutputNeuron(values[l])) 
    
    def backprop(self, previous_layer, desired_outputs):
        for i,neuron in enumerate(self.neurons):
            cost_derivative = 2 * (neuron.value - desired_outputs[i])
            sigmoid = 1 / (1 + math.exp(neuron.value * -1))
            activation_derivative = sigmoid * (1 - sigmoid)

            cost_derivative_to_bias = 1
            change_of_bias = cost_derivative_to_bias * activation_derivative * cost_derivative
            change_of_bias = 0.5 * change_of_bias
            neuron.bias = neuron.bias + change_of_bias

            for l,weight in enumerate(self.weights[i]):
                value_of_last_neuron = previous_layer.neurons[l].value
                cost_derivative_to_weight = value_of_last_neuron
                change_of_weight = cost_derivative_to_weight * activation_derivative * cost_derivative
                change_of_weight = 0.5 * change_of_weight
                self.weights[i][l] = weight + change_of_weight        

# todo bias auch mit in weights matrix 
class HiddenLayer(Layer):
    def __init__(self,number_neurons,number_input_weights):
        super().__init__()
        self.weights = numpy.random.ranf((number_neurons,number_input_weights))
        for l in range(0,number_neurons):
            self.neurons.append(HiddenNeuron()) 

    def backprop(self, previous_layer,desired_outputs):
        for i,neuron in enumerate(self.neurons):
            change_of_bias = 0
            changes_of_weights = []

            for k,previos_neuron in enumerate(previous_layer.neurons): 
                cost_derivative = 2 * (previos_neuron.value - desired_outputs[k])
                sigmoid = 1 / (1 + math.exp(neuron.value * -1))
                activation_derivative = sigmoid * (1 - sigmoid) 

                cost_derivative_to_bias = 1
                change_of_bias = (cost_derivative_to_bias * activation_derivative * cost_derivative)

                change_of_weight = 0
                for l,weight in enumerate(self.weights[i]):
                    value_of_last_neuron = previous_layer.neurons[l].value
                    cost_derivative_to_weight = value_of_last_neuron
                    change_of_weight = change_of_weight + cost_derivative_to_weight * activation_derivative * cost_derivative
                changes_of_weights.append(change_of_weight)

            for l,weight in enumerate(self.weights[i]):
                changes_of_weights[l] = 0.5 * changes_of_weights[l]
                changes_of_weights[l] = weight + changes_of_weights[l]

            self.weights[i] = changes_of_weights
            
            change_of_bias = 0.5 * change_of_bias
            neuron.bias = neuron.bias + change_of_bias

class NeuralNetwork():
    def __init__(self):
        # todo stepsize, number neurons = numer input weights
        self.hidden_layer = HiddenLayer(30,2)
        self.output_layer = OutputLayer(2,30,[0,1])

    def train(self):
        print("start training")
        # Iterate through train data
        errors = 0
        index = 0
        for i,item in enumerate(self.train_data):
            print("train image " + str(i) + " of " + str(len(self.train_data)))
            # Forwarding throug all three layers 
            
            # First Layer
            self.input_layer = InputLayer([item[0], item[1]])
            # Hidden Layer
            self.hidden_layer.forward(self.input_layer)
            # Output Layer
            self.output_layer.forward(self.hidden_layer)

            # Check output value of each output neuron and adjust weights and biases by backpropagation
            prediction = None
            prediction_prob = 0
            desired_probs = []
            print(self.output_layer.weights)
            # Set prediction as reference value from outputlayer with the highest activation
            for i,neuron in enumerate(self.output_layer.neurons):
                desired_output = item[2]
                if desired_output == neuron.reference:
                    desired_probs.append(1)
                else:
                    desired_probs.append(0)
                        
                if neuron.activation > prediction_prob:
                    prediction_prob = neuron.activation
                    prediction = neuron.reference
            
            if prediction != desired_output:
                errors += 1 
            index += 1
            print("Average wrong results: " + str(errors/index*100))
            
            self.output_layer.backprop(self.hidden_layer,desired_probs)
            self.hidden_layer.backprop(self.input_layer,desired_probs)
            

    def cost(self, value, desired_output):
        # squared error
        return (value - desired_output) * (value - desired_output)
        
    def test(self):
        print("start testing")
        errors = 0
        for item in self.test_data:
            prediction = self.predict(item[0], item[1])
            print("Predicted " + str(prediction))
            if prediction is not item[2]:
                errors = errors + 1
        print(errors / len(self.test_data) * 100)

    def load_data(self, train_data, test_data):
        print("loading data")
        self.train_data = train_data
        self.test_data = test_data
        
    def predict(self,item1, item2):
        # Forwarding throug all three layers 
        # First Layer
        self.input_layer = InputLayer([item1, item2])

        # Hidden Layer
        self.hidden_layer.forward(self.input_layer)
        
        # Output Layer
        self.output_layer.forward(self.hidden_layer)

        # Prediction results 
        prediction = None
        prediction_prob = 0
        for i,neuron in enumerate(self.output_layer.neurons):
            if neuron.activation > prediction_prob:
                prediction_prob = neuron.activation
                prediction = neuron.reference
        return prediction

if __name__ == "__main__":
    neural_network = NeuralNetwork()
    train_data = [
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],   
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],            
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
                        [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],        
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
                        [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
                        [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,0,0],
            [1,1,1],
            [0,0,0],
            [0,1,0],
            [1,1,1],
            [1,0,0],
            [1,1,1],
            [0,0,0],
        ]

    test_data = [[1,1,1], [1,0,0], [0,0,0], [1,1,1], [1,0,0], [0,0,0],[1,1,1], [1,0,0], [0,0,0], [1,1,1], [1,0,0], [0,0,0]]
    neural_network.load_data(train_data, test_data)
    neural_network.train()
    neural_network.test()

